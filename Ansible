                                     Ansible
==========================================================================================================================================================================================================
1. Ansible is Open Source IT Configuration Managment Tool.
2. Push Based Mechanism.
3. Agentless and SSH Security
4. 

=========================================================================================================================================================================================================
*Local Repository Create a Repository:


[On Controll Node]---Create Yum Repository
#cd /etc/yum.repos.d/
#ll
#vim local.repo  ====> Create a file 

[BASEID]
name=BaseOS
baseurl=file:///run/media/lalit/RHEL-9-1-0-BaseOS-x86_64/BaseOS
gpgcheck=0
enabled=1

[APPID]
name=Apps
baseurl=file:///run/media/lalit/RHEL-9-1-0-BaseOS-x86_64/AppStream
gpgcheck=0
enabled=1

:wq![Save & Quite]

#dnf repolist all 
o/p : Showing status enabled


#dnf install httpd ====> Install httpd Package (Web Package)

#systemctl start httpd.service

#systemctl enabled httpd.service

Enabled Firewall Service:
#firewall-cmd --list-services
#firewall-cmd --permanent --add-service=http
#firewall-cmd --reload
#firewall-cmd --list-services
#curl workstation

#cd /var/www/html

#mkdir DVD

#cd DVD

#cp -rvf /run/media/lalit/RHEL-9-1-0-BaseOS-x86_64/* . ======> copy all the file in current Directory

=============================================================================================================================================================

[On Managed Node]--- Create Yum Repository [Online Repository]

#cd /etc/yum.repos.d/
#ll
#vim local.repo  ====> Create a file 

#vim local.repo  ====> Create a file 

[BASEID]
name=BaseOS
baseurl=http://workstation/DVD/BaseOS
gpgcheck=0
enabled=1

[APPID]
name=Apps
baseurl=http://workstation/DVD/AppStream
gpgcheck=0
enabled=1

:wq![Save & Quite]

#dnf repolist all 
o/p : Showing status enabled

======================================================================================================================================================

Creating a user on on all machine

#adduser ansible

#passwd ansible

Step 2: Assigning a Sudo permision to ansible machine on all machine.

#vim /etc/sudoers.d/ansible

ansible ALL=(ALL)  NOPASSWD:ALL

Login using ansible user.

#su - ansible

#ssh-keygen

#cd .ssh

#ssh-copied ansible@192.168.136.163    =======> Copy public key of master machine to managed node.

#ssh ansible@192.168.136.163   =====> Login Successfuly 

===============================================================================================================================================================
[On Controll Node]
#dnf install python3-pip
#pip3.9 install 'ansible-navigator[ansible-core]'==2.1.0

Login using ansible user #su - ansible

#mkdir ansible  ====> Create Directory 
#cd ansible

#ansible-navigator

#ansible-navigator --version
o/p ansible [core 2.15.13]

#ansible --list-host prod 
o/p: hosts (1):
    192.168.136.163
	
#ansible --list-host all   =====> Showing all the managed node 
o/p: hosts (2):
    192.168.136.153
    192.168.136.163

#ansible --version
Output:
ansible [core 2.15.13]
  config file = /home/ansible/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.9/site-packages/ansible
  ansible collection location = /home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.9.14 (main, Sep 21 2022, 00:00:00) [GCC 11.3.1 20220421 (Red Hat 11.3.1-2)] (/usr/bin/python3)
  jinja version = 3.1.6
  libyaml = True

------------------------------------------------------------------------------------------------------------------------------------------------------------
[On Controll Node]

Login using ansible user   #su - ansible

#cd ansible

Create a ansible.cfg file
#vim ansible.cfg

[defaults]
inventory = ./inventory
remote_user = ansible
ask_pass = false
interpreter_python = /usr/bin/python3

[privilege-escalation]
become = true
become_method = sudo
become_user = root
become_ask_pass = false
--------------------------------------------------------------------------------------------------------------
*Create inventory  [On Controll Node]

#vim inventory

#This is ungroup
192.168.136.149
192.168.136.163
192.168.136.164

[prod]
192.168.136.156

[dev]
192.168.136.163
192.168.136.164

[myserver:children]
prod
dev

-----------------------------------------------------------------------------------------------------------------------------------------------------
[ansible@workstation ansible]$ ansible-inventory --graph  ===================> Showing all the connected nodes and groups

@all:
  |--@ungrouped:
  |--@myserver:
  |  |--@prod:
  |  |  |--192.168.136.149
  |  |--@dev:
  |  |  |--192.168.136.163
  |  |  |--192.168.136.164


#ansible-doc --list    ========================>  Showing the list of all modules

#ansible-doc  yum   ==========================> Complete detail of yum module

==============================================================================================================================================================
Ansible Playbook:

Add User:

#vim adduser.yaml

---
- name: add user temipadm
  hosts: 192.168.136.184
  become: true
  tasks:
    - name: add user temipadm
      ansible.builtin.user:
        name: temipadm
        state: present

:wq!

# ansible-playbook adduser.yaml --synatx-check =========> Check Syntax before run playbook

#ansible-playbook adduser.yaml ============> Run Playbook 

#ansible -m command -a "cat /etc/passwd"   OR ansible servera -m shell -a "getent passwd temipadm"  OR ansible servera -m command -a "getent passwd temipadm








